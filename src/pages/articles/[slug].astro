---
import { getCollection, getEntryBySlug } from "astro:content";
import ArticleLayout from "../../layouts/ArticleLayout.astro";

// Tell Astro which slugs exist
export async function getStaticPaths() {
  const allArticles = await getCollection("articles");
  return allArticles.map((article) => ({
    params: { slug: article.slug },
  }));
}

const { slug } = Astro.params;
const entry = await getEntryBySlug("articles", slug);
if (!entry) {
  return Astro.redirect("/404");
}

const { Content, data: frontmatter } = await entry.render();
---

<ArticleLayout {frontmatter} slug={slug}>
  <Content />
</ArticleLayout>
